(function(){"use strict";var e={8708:function(e,t,n){var o=n(9242),r=n(3396);const c=(0,r._)("h1",null,"CVE Feed",-1),i=["disabled"],s={key:0},l={key:1};function u(e,t,n,o,u,a){const d=(0,r.up)("router-view"),v=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[c,(0,r._)("div",null,[(0,r._)("input",{class:"btn btn-success",type:"button",value:"Sync",onClick:t[0]||(t[0]=(...e)=>a.sync&&a.sync(...e)),disabled:u.syncing},null,8,i),u.commsProblems?((0,r.wg)(),(0,r.iD)("p",s," Problems reaching NVD. ")):(0,r.kq)("",!0),u.syncing?((0,r.wg)(),(0,r.iD)("p",l,"Syncing now!")):(0,r.kq)("",!0)]),(0,r.Wm)(d),(0,r._)("ul",null,[(0,r._)("li",null,[(0,r.Wm)(v,{to:"/"},{default:(0,r.w5)((()=>[(0,r.Uk)("Home")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(v,{to:"/keyword-list"},{default:(0,r.w5)((()=>[(0,r.Uk)("Keywords")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(v,{to:"/cve-list"},{default:(0,r.w5)((()=>[(0,r.Uk)("CVE List")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(v,{to:"/date"},{default:(0,r.w5)((()=>[(0,r.Uk)("CVEs by Date")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(v,{to:"/about"},{default:(0,r.w5)((()=>[(0,r.Uk)("About")])),_:1})])])],64)}const a=e=>new Promise((function(t,n){let o=new Date;o=new Date(o-o%864e5);let r=new Date(o);r.setDate(o.getDate()+1),o.setDate(o.getDate()-1),fetch("https://services.nvd.nist.gov/rest/json/cves/2.0?pubStartDate="+o.toISOString()+"&pubEndDate="+r.toISOString()+"&keywordSearch="+e).then((function(e){return e.json()})).then((function(e){t(e.vulnerabilities)})).catch((function(e){n(e)}))})),d=e=>new Promise((function(t,n){return fetch("https://services.nvd.nist.gov/rest/json/cves/2.0?cveId="+e).then((function(e){return e.json()})).then((function(e){t(e.vulnerabilities.pop())})).catch((function(e){n(e)}))}));n(7658);var v=()=>new Promise(((e,t)=>{let n=window.indexedDB.open("cve-feed",1);n.onerror=e=>{t(e)},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{const t=e.target.result;let n=t.createObjectStore("cves",{keyPath:"cveId"});n.createIndex("dateIdx","createdAt"),n=t.createObjectStore("keywords",{autoIncrement:!0,keyPath:"id"}),n.createIndex("termIdx","term",{unique:!0})}}));const f=(e,t)=>g(e).then((function(e){return v().then((function(n){return new Promise(((o,r)=>{let c=n.transaction(["keywords"],"readwrite");c.oncomplete=()=>{o(t)},c.onerror=e=>{r(e)};let i=c.objectStore("keywords");e.cveIds=t,i.put(e)}))})).catch((function(e){console.log("addKeyword failed"),console.error(e)}))})),h=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["keywords"],"readwrite");r.oncomplete=()=>{n()},r.onerror=e=>{o(e)};let c=r.objectStore("keywords");c.add({createdAt:(new Date).getTime(),term:e,cveIds:[]})}))})).catch((function(e){console.log("addKeyword failed"),console.error(e)})),m=()=>v().then((function(e){return new Promise(((t,n)=>{let o=e.transaction(["keywords"],"readonly");o.oncomplete=()=>{t(c.reverse())},o.onerror=e=>{n(e)};let r=o.objectStore("keywords"),c=[];r.openCursor().onsuccess=e=>{let t=e.target.result;t&&(c.push(t.value),t.continue())}}))})).catch((function(e){console.log("getKeyword failed"),console.error(e)})),w=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["keywords"],"readwrite");r.oncomplete=()=>{n()},r.onerror=e=>{o(e)};let c=r.objectStore("keywords");c.delete(e)}))})).catch((function(e){console.log("removeKeyword failed"),console.error(e)})),p=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["keywords"],"readwrite");r.onerror=e=>{o(e)};let c=r.objectStore("keywords");c.get(e).onsuccess=function(e){const t=e.target.result;n(t)}}))})).catch((function(e){console.log("removeKeyword failed"),console.error(e)})),g=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["keywords"],"readonly");r.onerror=e=>{o(e)};let c=r.objectStore("keywords");const i=IDBKeyRange.only(e),s=c.index("termIdx"),l=s.openCursor(i);l.onsuccess=e=>{const t=e.target.result;n(t?t.value:null)}}))})).catch((function(e){console.log("removeKeyword failed"),console.error(e)})),y=e=>(console.log(e),new Promise((function(t,n){return _(e.id).then((o=>v().then((function(r){let c=r.transaction(["cves"],"readwrite");c.oncomplete=()=>{t(e)},c.onerror=e=>{n(e)};let i=c.objectStore("cves");if(o)o.filtered=!0,i.put(o);else{let t={};t.createdAt=(new Date).getTime(),t.terms=[],t.cveId=e.cve.id,t.cve=e.cve,t.filtered=!1,i.put(t)}}))))}))),k=(e,t)=>{let n=[];return new Promise((function(o,r){return 0===e.length?o(n):Promise.all(e.map((e=>(e.filtered||n.push(e.cve.id),_(e.cve.id).then((c=>v().then((function(i){let s=i.transaction(["cves"],"readwrite");s.oncomplete=()=>{o(n)},s.onerror=e=>{r(e)};let l=s.objectStore("cves");return c?c.terms.includes(t)?void 0:(c.terms.push(t),c.filtered=!1,l.put(c)):l.add({createdAt:(new Date).getTime(),terms:[t],cveId:e.cve.id,cve:e.cve,filtered:!1})}))))))))}))},b=()=>v().then((function(e){return new Promise(((t,n)=>{let o=e.transaction(["cves"],"readonly");o.oncomplete=()=>{t(c)},o.onerror=e=>{n(e)};let r=o.objectStore("cves"),c=[];r.openCursor().onsuccess=e=>{let t=e.target.result;t&&(t.value.filtered||c.push(t.value),t.continue())}}))})).catch((function(e){console.log("getCveList failed"),console.error(e)})),D=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["cves"],"readwrite");r.onerror=e=>{o(e)};let c=r.objectStore("cves");c.get(e).onsuccess=e=>{const t=e.target.result;t&&(t.filtered=!0,c.put(t)),n(t)}}))})).catch((function(e){console.log("removeCve failed"),console.error(e)})),_=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["cves"],"readonly");r.onerror=e=>{o(e)};let c=r.objectStore("cves");c.get(e).onsuccess=function(e){n(e.target.result)}}))})).catch((function(e){console.log("getCveByCveId failed"),console.error(e)})),C=e=>v().then((function(t){return new Promise(((n,o)=>{let r=t.transaction(["cves"],"readonly"),c=[];r.oncomplete=()=>{n(c)},r.onerror=e=>{o(e)};let i=r.objectStore("cves"),s=e.getTime();s-=s%864e5;const l=IDBKeyRange.bound(s,s+864e5),u=i.index("dateIdx"),a=u.openCursor(l);a.onsuccess=e=>{const t=e.target.result;t&&(t.value.filtered||c.push(t.value),t.continue())}}))})).catch((function(e){console.log("removeKeyword failed"),console.error(e)}));var I={name:"App",data(){return{syncing:!1,commsProblems:!1}},created(){this.sync()},methods:{sync(){const e=this;e.syncing=!0,m().then((function(t){return Promise.allSettled(t.map((function(t,n){return e.pull(t.term,n).catch((function(){e.commsProblems=!0}))}))).then((function(){e.syncing=!1,e.commsProblems=!1})).catch((function(){e.syncing=!1,e.commsProblems=!0}))}))},pull(e,t){return new Promise((function(n){setTimeout((function(){a(e).then((function(t){return 0===t.length?n():k(t,e).then((function(t){return f(e,t)})).then((function(){return n()}))}))}),10*t*1e3)}))}}},P=n(89);const L=(0,P.Z)(I,[["render",u]]);var S=L;const j=(0,r._)("h2",null,"About",-1),K=[j];function O(e,t,n,o,c,i){return(0,r.wg)(),(0,r.iD)("div",null,K)}var V={name:"AboutPage"};const z=(0,P.Z)(V,[["render",O]]);var A=z;const E=(0,r._)("p",null,"CVE Feed is a way to manage CVE data",-1),T=[E];function U(e,t,n,o,c,i){return(0,r.wg)(),(0,r.iD)("div",null,T)}var x={name:"HomePage"};const W=(0,P.Z)(x,[["render",U]]);var H=W,N=n(7139);const q=(0,r._)("h2",null,"Keywords",-1),F={class:"controls"},Z=["disabled"],Y=["onClick"];function B(e,t,n,c,i,s){const l=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[q,(0,r._)("div",null,[(0,r._)("p",null,(0,N.zw)(i.msg),1),(0,r._)("div",F,[(0,r.wy)((0,r._)("input",{placeholder:"New Keyword",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.currentTerm=e),onBlur:t[1]||(t[1]=(...e)=>s.check&&s.check(...e)),onKeyup:t[2]||(t[2]=(...e)=>s.check&&s.check(...e))},null,544),[[o.nr,i.currentTerm]]),(0,r._)("input",{class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=(...e)=>s.add&&s.add(...e)),value:"Add",disabled:0===i.currentTerm.length||i.alreadyAdded},null,8,Z)]),(0,r._)("ul",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.keywordList,((e,t)=>((0,r.wg)(),(0,r.iD)("li",{key:e.id},[(0,r._)("div",null,[(0,r._)("p",null,[(0,r.Uk)((0,N.zw)(t+1)+" - ",1),(0,r.Wm)(l,{to:"/keyword/"+e.id},{default:(0,r.w5)((()=>[(0,r.Uk)((0,N.zw)(e.term),1)])),_:2},1032,["to"]),(0,r.Uk)(),(0,r._)("input",{class:"btn btn-danger",type:"button",value:"Remove Term",onClick:t=>s.remove(e)},null,8,Y)]),(0,r._)("p",null,(0,N.zw)(e.cveIds.length)+" CVEs aggregated for this keyword",1)])])))),128))])])],64)}var R={name:"KeywordListPage",data(){return{msg:"",alreadyAdded:!1,currentTerm:"",keywordList:[]}},methods:{add(){const e=this.currentTerm.trim();if(e){const t=this;g(e).then((function(n){n?(t.msg="Term Already Exists",t.getList()):h(e).then((function(){t.getList(),t.currentTerm="",t.alreadyAdded=!1}))}))}},remove(e){const t=this;w(e.id).then((function(){t.getList()}))},check(){this.alreadyAdded=!1;const e=this.currentTerm.trim();if(e){const t=this;g(e).then((function(e){e&&(t.alreadyAdded=!0,t.msg="Term Already Exists")}))}},getList(){const e=this;return m().then((function(t){e.keywordList=t.filter((e=>!e.filtered))}))}},mounted(){this.getList()}};const M=(0,P.Z)(R,[["render",B]]);var $=M;const G={key:0},J=(0,r._)("p",null,"No Results",-1),Q=[J];function X(e,t,n,o,c,i){const s=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("h2",null,'Keyword "'+(0,N.zw)(c.currentKeyword)+'"',1),(0,r._)("div",null,[0===c.cveList.length?((0,r.wg)(),(0,r.iD)("div",G,Q)):(0,r.kq)("",!0),(0,r._)("div",null," Keyword created: "+(0,N.zw)(new Date(c.createdDate)),1),(0,r._)("ul",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(c.cveList,((e,t)=>((0,r.wg)(),(0,r.iD)("li",{key:e},[(0,r.Uk)((0,N.zw)(t+1)+" - ",1),(0,r.Wm)(s,{to:"/cve/"+e},{default:(0,r.w5)((()=>[(0,r.Uk)((0,N.zw)(e),1)])),_:2},1032,["to"])])))),128))])])],64)}var ee={name:"KeywordPage",props:{id:{type:[Number]}},data(){return{currentKeyword:"",cveList:[],createdDate:""}},methods:{getKeyword(){const e=this;p(Number.parseInt(this.id)).then((function(t){e.currentKeyword=t.term,e.cveList=t.cveIds,e.createdDate=t.createdAt}))},remove(e){const t=this;w(e.id).then((function(){t.getList()}))}},mounted(){this.getKeyword()}};const te=(0,P.Z)(ee,[["render",X]]);var ne=te;const oe=(0,r._)("h2",null,"CVE List",-1),re={class:"controls"},ce=["disabled"],ie={key:0},se=(0,r._)("p",null,"No CVE Found",-1),le=[se],ue={key:0},ae=["onClick"];function de(e,t,n,c,i,s){const l=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",null,[oe,(0,r._)("div",re,[(0,r.wy)((0,r._)("input",{placeholder:"New CVE",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.oneOffCve=e),onBlur:t[1]||(t[1]=(...t)=>e.check&&e.check(...t)),onKeyup:t[2]||(t[2]=(...t)=>e.check&&e.check(...t))},null,544),[[o.nr,i.oneOffCve]]),(0,r._)("input",{class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=(...e)=>s.add&&s.add(...e)),value:"Add",disabled:!s.newCveIsValidId},null,8,ce)]),i.noCveFound?((0,r.wg)(),(0,r.iD)("div",ie,le)):(0,r.kq)("",!0),(0,r._)("ul",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.cveList,((e,t)=>((0,r.wg)(),(0,r.iD)("li",{key:e.cveId},[(0,r._)("p",null,[(0,r.Uk)((0,N.zw)(t+1)+" - ",1),(0,r.Wm)(l,{to:"/cve/"+e.cveId},{default:(0,r.w5)((()=>[(0,r.Uk)((0,N.zw)(e.cveId),1)])),_:2},1032,["to"]),(0,r.Uk)(),e.terms.length>0?((0,r.wg)(),(0,r.iD)("span",ue,"("+(0,N.zw)(e.terms.join(", "))+")",1)):(0,r.kq)("",!0)]),(0,r._)("input",{class:"btn btn-danger",type:"button",value:"Remove CVE",onClick:t=>s.remove(e)},null,8,ae)])))),128))])])}var ve={name:"CveListPage",computed:{newCveIsValidId(){return(this.oneOffCve.startsWith("CVE-")||this.oneOffCve.startsWith("cve-"))&&this.oneOffCve.substring(4).split("-").every((function(e){return/^\d+$/.test(e)}))}},data(){return{oneOffCve:"",cveList:[],noCveFound:!1}},methods:{add(){const e=this;d(this.oneOffCve).then((function(t){t?y(t).then((function(){e.getList()})):e.noCveFound=!0}))},remove(e){const t=this;D(e.cveId).then((function(t){return Promise.all(t.terms.map((t=>g(t).then((function(n){return f(t,n.cveIds.filter((function(t){return t!==e.cveId})))})))))})).then((function(){t.getList()}))},getList(){const e=this;b().then((function(t){e.cveList=t}))}},mounted(){this.getList()}};const fe=(0,P.Z)(ve,[["render",de]]);var he=fe;const me={key:0},we=["href"];function pe(e,t,n,o,c,i){return(0,r.wg)(),(0,r.iD)("div",null,[(0,r._)("h2",null,(0,N.zw)(n.cveId),1),c.cve.cve?((0,r.wg)(),(0,r.iD)("div",me,[(0,r._)("p",null,(0,N.zw)(c.cve.cve.descriptions.find((e=>"en"==e.lang)).value),1),(0,r._)("p",null,"Published: "+(0,N.zw)(new Date(c.cve.cve.published)),1),(0,r._)("p",null,"Cached in CVE-Feed: "+(0,N.zw)(new Date(c.cve.createdAt)),1),(0,r._)("p",null,"Discovered for Keywords: "+(0,N.zw)(c.cve.terms.join(", ")),1),(0,r._)("a",{href:"https://nvd.nist.gov/vuln/detail/"+c.cve.cveId},"NVD Link",8,we)])):(0,r.kq)("",!0)])}var ge={name:"CvePage",data(){return{cve:{}}},props:["cveId"],methods:{getCve(){const e=this;_(this.cveId).then((function(t){e.cve=t}))}},mounted(){this.getCve()}};const ye=(0,P.Z)(ge,[["render",pe]]);var ke=ye;const be=(0,r._)("label",{for:"start"},"Show CVEs from this Date:",-1),De={key:0},_e={class:"container"};function Ce(e,t,n,c,i,s){const l=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",null,[be,(0,r.wy)((0,r._)("input",{type:"date",id:"start","onUpdate:modelValue":t[0]||(t[0]=e=>i.createdDate=e)},null,512),[[o.nr,i.createdDate]]),(0,r._)("input",{class:"btn btn-secondary",value:"Change Date",onClick:t[1]||(t[1]=(...e)=>s.changeDate&&s.changeDate(...e))}),(0,r._)("h2",null,"CVE List for "+(0,N.zw)(i.createdDate),1),0===i.cveList.length?((0,r.wg)(),(0,r.iD)("p",De,"No CVEs for this date.")):(0,r.kq)("",!0),(0,r._)("ul",_e,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.cveList,((e,t)=>((0,r.wg)(),(0,r.iD)("li",{key:e.cveId},[(0,r.Uk)((0,N.zw)(t+1)+" - "+(0,N.zw)(e.cveId)+" ("+(0,N.zw)(e.terms.join(", "))+") ",1),(0,r.Wm)(l,{to:"/cve/"+e.cveId},{default:(0,r.w5)((()=>[(0,r.Uk)("See Details")])),_:2},1032,["to"])])))),128))])])}var Ie={name:"DatePage",data(){return{createdDate:new Date,cveList:[]}},methods:{getCveList(e){const t=this;t.createdDate=e,C(e).then((function(e){t.cveList=e}))},changeDate(){this.getCveList(new Date(this.createdDate))}},mounted(){this.getCveList(new Date)}};const Pe=(0,P.Z)(Ie,[["render",Ce]]);var Le=Pe,Se=n(2483);n(2166);const je=[{path:"/",component:H},{path:"/about",component:A},{path:"/keyword-list",component:$},{path:"/keyword/:id",component:ne,props:!0},{path:"/cve-list",component:he},{path:"/cve/:cveId",component:ke,props:!0},{path:"/date",component:Le}],Ke=(0,Se.p7)({history:(0,Se.r5)(),routes:je}),Oe=(0,o.ri)(S);Oe.use(Ke),Oe.mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,c){if(!o){var i=1/0;for(a=0;a<e.length;a++){o=e[a][0],r=e[a][1],c=e[a][2];for(var s=!0,l=0;l<o.length;l++)(!1&c||i>=c)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(s=!1,c<i&&(i=c));if(s){e.splice(a--,1);var u=r();void 0!==u&&(t=u)}}return t}c=c||0;for(var a=e.length;a>0&&e[a-1][2]>c;a--)e[a]=e[a-1];e[a]=[o,r,c]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,c,i=o[0],s=o[1],l=o[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var a=l(n)}for(t&&t(o);u<i.length;u++)c=i[u],n.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return n.O(a)},o=self["webpackChunkcve_feed"]=self["webpackChunkcve_feed"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(8708)}));o=n.O(o)})();
//# sourceMappingURL=app.d1a3e88a.js.map